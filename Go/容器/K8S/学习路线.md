

我给你一套**最正统、最硬核、可直接落地**的 K8s 学习路线：
**原理 + 源码结构 + 官方权威文档 + 学习顺序**，一次性给全，你照着走就能从 0 学到精通。

# 一、先一句话抓住 K8s 本质（原理核心）
Kubernetes = **容器编排平台**
本质就是：
**一套用 Go 写的、分布式、声明式、面向终态的“集群操作系统”**。

它的核心逻辑只有 4 个：
1. **声明式 API**：你告诉它“我要什么”，它自己搞定怎么实现
2. **控制器模式（Controller）**：无限循环，确保实际状态 = 期望状态
3. **ETCD 唯一可信源**：所有数据只存在这里
4. **组件松耦合 + 可扩展**：Scheduler、Controller、Kubelet 都是独立模块

---

# 二、K8s 官方 & 权威文档（唯一正确学习来源）
## 1. 官方顶级文档（必看）
- **K8s 官网**
  https://kubernetes.io/
- **K8s 官方文档（概念篇，原理核心）**
  https://kubernetes.io/docs/concepts/
- **K8s 任务手册**
  https://kubernetes.io/docs/tasks/
- **K8s API 文档（学源码必看）**
  https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.30/

## 2. 源码仓库（真正的 K8s 本体）
https://github.com/kubernetes/kubernetes

## 3. 社区权威文档
- **K8s 贡献指南（带你读源码）**
  https://github.com/kubernetes/community
- **K8s 架构设计**
  https://kubernetes.io/docs/concepts/overview/components/

## 4. 权威书籍（最正统）
- 《Kubernetes in Action》（入门神书）
- 《Kubernetes 权威指南》（国内官方级）
- 《Deep Dive into Kubernetes》（源码级）

---

# 三、K8s 原理学习路径（从外到内，最科学）
## 阶段1：先搞懂 K8s 架构（必须先懂这个）
K8s 分为 **Master 节点 + Node 节点**

### Master 组件（大脑）
- **kube-apiserver**
  唯一入口、认证授权、校验、操作 etcd
- **etcd**
  键值存储，唯一可信数据源
- **kube-controller-manager**
  所有控制器（Deployment/ReplicaSet/Service 等）
- **kube-scheduler**
  调度器：决定 Pod 跑在哪台机器

### Node 组件（手脚）
- **kubelet**
  节点代理人，管理本节点 Pod
- **kube-proxy**
  维护网络规则（Service 访问）
- **容器运行时（containerd）**
  真正启动容器

---

## 阶段2：核心原理（必须吃透）
### 1. 声明式 API & 终态协调
你写 YAML → 发给 apiserver → 存入 etcd
Controller 无限 watch → 对比差异 → 调协

这是 K8s 的灵魂。

### 2. Controller 模式（所有功能的基础）
```go
for {
  实际状态 := 获取集群状态()
  期望状态 := 获取用户定义()
  if 实际状态 == 期望状态 {
     continue
  }
  执行调协逻辑()
}
```

### 3. Scheduler 调度原理
1. 预选（Predicate）
2. 优选（Priority）
3. 绑定（Bind）

### 4. Kubelet 工作原理
- 监听 Pod
- 创建容器
- 健康检查
- 上报状态

### 5. 网络原理
- Service
- CNI
- Service → Endpoint → Pod IP

### 6. 存储原理
- PV/PVC
- StorageClass
- CSI 插件

---

# 四、K8s 源码学习路线（最清晰、最不迷路）
## 1. 源码目录结构（必须背下来）
```
kubernetes/
├── cmd/             # 各个组件入口（apiserver、controller-manager、scheduler、kubelet）
├── pkg/             # 核心功能库（80% 逻辑在这里）
├── staging/         # 客户端、API 定义
├── api/             # API 定义
├── plugin/          # 插件（调度器、网络等）
└── vendor/           # 依赖
```

## 2. 按组件学习（最稳顺序）
### ① kube-apiserver（入口）
- 入口：`cmd/kube-apiserver`
- 核心：`pkg/registry`、`pkg/apiserver`
- 作用：认证、鉴权、准入、存储

### ② controller-manager（控制平面）
- 入口：`cmd/kube-controller-manager`
- 核心：`pkg/controller`
- 必学：
    - deployment_controller
    - replicaset_controller
    - service_controller

### ③ scheduler（调度器）
- 入口：`cmd/kube-scheduler`
- 核心：`pkg/scheduler`

### ④ kubelet（节点核心）
- 入口：`cmd/kubelet`
- 核心：`pkg/kubelet`

---

# 五、源码怎么读？我给你一条「主线」
你只需要跟踪一条流程：
## 用户执行 kubectl apply → 最终 Pod 启动
这条流程走通，K8s 你就通了。

流程：
```
kubectl → apiserver → etcd
→ controller 监听变化
→ scheduler 挑选节点
→ apiserver 更新 Pod 节点信息
→ kubelet 监听并创建容器
→ kubelet 上报状态
→ apiserver 更新状态
→ 运行成功
```

你只要把这条流程的源码全部走一遍，你就是 K8s 高手。

---

# 六、最简单的上手方式（不用搭环境）
1. 去 GitHub 打开 kubernetes/kubernetes
2. 打开 `cmd/kube-apiserver`
3. 看 `main.go`
4. 打开 `pkg/controller/deployment`
5. 看调协循环
6. 打开 `pkg/scheduler`
7. 看调度算法

你不需要编译，也能看懂 70%。

---

# 七、我可以直接给你的东西
你只要说一声，我可以马上给你：
1. **K8s 源码流程图（apiserver/controller/scheduler/kubelet）**
2. **K8s 核心源码文件清单**
3. **Deployment 完整源码逐行解析**
4. **Scheduler 调度原理+源码解析**
5. **Kubelet 启动 Pod 源码解析**

你现在最想先搞懂哪一块？
我可以直接给你**最精简、最硬核的原理+源码讲解**。
















