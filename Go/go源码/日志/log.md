

你想了解 Go 语言中 `log` 标准库的相关用法和核心概念，我会从基础使用、核心功能到进阶技巧，帮你把 `log` 库讲清楚。

### 一、log 库的核心作用
`log` 是 Go 标准库中用于**日志输出**的基础包，提供了简单、轻量的日志打印能力，支持输出到控制台、文件等，还能自定义日志前缀、输出格式等，是 Go 程序中最基础的日志工具。

### 二、基础使用（开箱即用）
`log` 库提供了一组开箱即用的函数，无需初始化即可直接使用，最常用的有以下几个：

#### 1. 核心函数示例
```go
package main

import (
    "log"
)

func main() {
    // 1. 基础日志：输出内容 + 时间戳 + 换行
    log.Println("这是基础日志")

    // 2. 格式化日志：类似 fmt.Printf，支持格式化占位符
    log.Printf("格式化日志：数字=%d，字符串=%s\n", 100, "test")

    // 3. 致命日志：输出日志后，立即调用 os.Exit(1) 终止程序
    // log.Fatalln("致命日志，程序会退出")

    // 4. 恐慌日志：输出日志后，触发 panic（可被 recover 捕获）
    // log.Panicln("恐慌日志，触发panic")
}
```

#### 2. 输出效果（默认格式）
默认情况下，日志会输出到**标准错误流（stderr）**，格式为：
```
2026/02/22 10:30:00 这是基础日志
2026/02/22 10:30:00 格式化日志：数字=100，字符串=test
```
默认包含：`日期 时间 日志内容`，且自动换行。

### 三、自定义日志配置
如果默认格式满足不了需求，`log` 库支持自定义输出目标、前缀、是否显示时间等，核心是通过 `log.New` 创建自定义 Logger。

#### 1. 自定义 Logger 示例（输出到文件+自定义前缀）
```go
package main

import (
    "log"
    "os"
)

func main() {
    // 1. 打开/创建日志文件（不存在则创建，存在则追加）
    logFile, err := os.OpenFile(
        "app.log",        // 日志文件名
        os.O_CREATE|os.O_WRONLY|os.O_APPEND, // 模式：创建+写+追加
        0644,             // 文件权限：所有者可读可写，其他只读
    )
    if err != nil {
        log.Fatalf("打开日志文件失败：%v", err)
    }
    defer logFile.Close() // 程序退出前关闭文件

    // 2. 创建自定义 Logger
    // 参数说明：
    // - out：输出目标（这里是文件，也可以是 os.Stdout/os.Stderr）
    // - prefix：日志前缀
    // - flag：日志格式标记（控制显示哪些内容）
    customLogger := log.New(
        logFile,
        "[APP] ",                // 自定义前缀
        log.Ldate|log.Ltime|log.Lshortfile, // 格式标记：日期+时间+短文件名和行号
    )

    // 3. 使用自定义 Logger 输出日志
    customLogger.Println("自定义日志：程序启动")
    customLogger.Printf("自定义格式化日志：%s\n", "测试内容")
}
```

#### 2. 关键参数：flag 格式标记
`log` 库提供了多个标记常量，用于控制日志的输出格式，可组合使用：

| 常量            | 作用                                  |
|-----------------|---------------------------------------|
| `log.Ldate`     | 显示日期（2026/02/22）                |
| `log.Ltime`     | 显示时间（10:30:00）                  |
| `log.Lmicroseconds` | 显示微秒级时间（10:30:00.123456）    |
| `log.Llongfile` | 显示完整文件名+行号（/home/test/main.go:25） |
| `log.Lshortfile`| 显示短文件名+行号（main.go:25）       |
| `log.LstdFlags` | 默认标记（Ldate + Ltime）             |

### 四、log 库的局限性
`log` 是基础日志库，适合简单场景，但生产环境中存在明显不足：
1. 不支持**日志级别**（如 Debug/Info/Warn/Error）；
2. 不支持**日志切割**（文件会无限增大）；
3. 不支持结构化输出（如 JSON）；
4. 扩展性差，无法自定义复杂格式。

#### 生产环境替代方案
如果需要更强大的日志能力，推荐使用第三方库：
- `zap`（Uber 出品，高性能、结构化）；
- `logrus`（易用、支持级别和插件）；
- `zerolog`（极致性能、JSON 优先）。

### 总结
1. **核心功能**：`log` 是 Go 标准库的基础日志工具，支持基础的日志输出、自定义前缀/格式/输出目标；
2. **常用函数**：`Println/Printf`（普通日志）、`Fatalln`（终止程序）、`Panicln`（触发 panic）；
3. **自定义方式**：通过 `log.New` 创建 Logger，可指定输出文件、前缀、格式标记；
4. **适用场景**：简单的调试/小工具场景，生产环境建议用 zap/logrus 等第三方库。

如果需要具体场景的示例（比如日志切割、结构化日志），可以告诉我，我会补充对应的代码和说明。
















