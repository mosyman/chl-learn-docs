


[字节内部演进实录：Redis迁移Valkey](https://mp.weixin.qq.com/s/WKvk4O5gSY2zugzhBUOTCg)




你想了解 Valkey 和 Redis 之间的关系、核心差异，以及该如何选择，这是目前开源缓存领域的热门话题，我会从背景、核心区别、使用建议等方面帮你讲清楚。

### 一、核心背景：Valkey 是 Redis 的“社区分叉版”
Valkey（发音 /ˈvælki/）是 2024 年由亚马逊、谷歌、微软、红帽等大厂联合发起的 **Redis 社区分叉项目**，核心起因是：
1. Redis 原作者 Salvatore Sanfilippo 加入 AWS 后，Redis 项目的治理模式引发社区争议（比如核心维护权集中、开源协议未变但商业合作导向明显）；
2. 社区担心 Redis 未来的开源中立性，因此分叉出 Valkey，目标是**保持开源中立、社区主导、兼容 Redis 生态**。

简单说：**Valkey 是 Redis 的“平替版”，底层协议、命令、数据结构完全兼容，核心目标是延续 Redis 的开源精神**。

---

### 二、Valkey vs Redis 核心对比
| 维度                | Redis                                  | Valkey                                  |
|---------------------|----------------------------------------|-----------------------------------------|
| **项目定位**        | 商业公司主导（Redis Ltd/AWS），开源+商业版 | 社区主导（亚马逊/谷歌/微软等共建），纯开源中立 |
| **兼容性**          | 自身作为标准，持续迭代                 | 100% 兼容 Redis 7.x/8.x 协议、命令、API |
| **开发节奏**        | 商业需求优先，迭代速度可控             | 社区需求驱动，迭代更开放（比如更快合并社区PR） |
| **核心功能**        | 基础缓存、集群、持久化、流、搜索等     | 完全继承 Redis 核心功能，无功能缺失     |
| **企业支持**        | Redis Ltd 提供商业支持、企业版         | 亚马逊/谷歌/微软/红帽等提供企业级支持   |
| **生态工具**        | 成熟（客户端、监控、运维工具）         | 完全兼容 Redis 生态工具（无需修改代码） |
| **版本规划**        | 8.x 及后续由商业团队主导               | 基于 Redis 7.2 分叉，已发布 8.0/8.1 版本 |

#### 关键细节补充：
1. **兼容性无感知**：你的 Java/Python/Go 等 Redis 客户端（如 Jedis、Redisson、redis-py）无需修改一行代码，只需将连接地址指向 Valkey 服务即可；
2. **无功能阉割**：Valkey 完整保留了 Redis 的所有核心特性（String/Hash/List/Set/ZSet、Redis Cluster、RDB/AOF、Streams、Pub/Sub 等）；
3. **社区治理**：Valkey 采用 CNCF 风格的社区治理模式，决策更透明，避免单一主体控制。

---

### 三、核心差异：为什么要分叉？
1. **治理模式（核心原因）**：
    - Redis：核心维护权集中在 Redis Ltd（后被 AWS 收购），社区 PR 合并速度慢，商业需求优先级高于社区需求；
    - Valkey：由多家大厂组成的技术指导委员会（TSC）治理，社区贡献更易被采纳，决策公开透明。
2. **商业绑定**：
    - Redis：推出商业版 Redis Enterprise，部分高级功能（如 Active-Active 集群）仅商业版提供；
    - Valkey：无商业版，所有功能开源，企业可免费使用、二次开发。
3. **迭代方向**：
    - Redis：更贴合 AWS 等商业云厂商的产品路线；
    - Valkey：更关注社区痛点（如性能优化、稳定性、多架构适配）。

---

### 四、该怎么选？
#### 选 Redis 的场景：
1. 已深度使用 Redis 商业版（Redis Enterprise），依赖其专属功能（如 Active-Active、多租户）；
2. 项目对“官方商业支持”有强依赖，愿意为 Redis Ltd 的技术支持付费；
3. 业务处于稳定期，不想切换底层组件（Redis 短期内仍会保持兼容，无迁移风险）。

#### 选 Valkey 的场景：
1. 追求**开源中立**，担心 Redis 未来闭源或修改开源协议；
2. 仅使用 Redis 开源版核心功能（缓存、集群、持久化），无商业版依赖；
3. 希望参与社区共建，或需要更快的社区需求响应；
4. 部署在云原生环境（Valkey 对 K8s、容器化的适配更积极）。

#### 过渡建议：
- 短期：无需紧急切换，Redis 和 Valkey 完全兼容，可先在测试环境部署 Valkey 验证；
- 长期：如果你的团队/公司重视开源中立，可逐步将 Redis 替换为 Valkey（无代码改造成本）。

---

### 总结
1. **核心关系**：Valkey 是 Redis 的社区分叉版，100% 兼容 Redis 协议/API，无功能差异；
2. **核心区别**：治理模式（社区主导 vs 商业主导）、商业绑定（纯开源 vs 开源+商业版）；
3. **选型原则**：依赖 Redis 商业功能/支持选 Redis，追求开源中立/社区驱动选 Valkey，短期切换无成本。

补充：目前 Valkey 已被多家云厂商（AWS、GCP、Azure）纳入托管服务计划，生态正在快速完善，是 Redis 开源版的优质替代方案。

需要我帮你整理一份 **Valkey 快速部署教程**（Docker/K8s），让你快速体验 Valkey 和 Redis 的兼容性吗？







